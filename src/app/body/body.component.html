<div class="upload-section" *ngIf="showUploadForm">
  <input
    type="file"
    (change)="loadFiles($event)"
    accept=".zip"
    class="form-control"
  />
</div>

<div *ngIf="fileUploaded">
  <ul class="nav nav-tabs">
    <li class="nav-item">
      <a class="nav-link active">{{ zipFile?.name }}</a>
    </li>
  </ul>

  <div class="dropdown-section">
    <label for="dropdownMenuButton" class="form-label">Log ausw채hlen:</label>
    <select
      id="dropdownMenuButton"
      class="form-select"
      [(ngModel)]="selectedFileName"
      (change)="onFileSelectionChange(selectedFileName)"
    >
      <option value="" disabled selected>Bitte w채hlen...</option>
      <option *ngFor="let file of zipContents" [value]="file.name">
        {{ file.name | slice : file.name.lastIndexOf("/") + 1 }}
      </option>
    </select>
  </div>

  <dx-data-grid
    *ngIf="logsDataSource.length > 0"
    [dataSource]="logsDataSource"
    [columns]="['Datum', 'Uhrzeit', 'Loglevel', 'Nachricht', 'Thema']"
    [allowColumnResizing]="true"
    [columnAutoWidth]="false"
    [width]="'100%'"
    [height]="700"
    [showBorders]="true"
  >
    <dxo-filter-row [visible]="true"></dxo-filter-row>
    <dxo-toolbar>
      <dxi-item name="groupPanel"></dxi-item>
      <dxi-item location="after">
        <dx-button
          icon="undo"
          text="Ansicht zur체cksetzen"
          (click)="resetGrid(logGrid)"
        ></dx-button>
      </dxi-item>
      <dxi-item name="searchPanel"></dxi-item>
    </dxo-toolbar>
    <dxo-search-panel [visible]="true"></dxo-search-panel>

    <dxo-scrolling mode="virtual"></dxo-scrolling>
    <dxo-group-panel [visible]="true"></dxo-group-panel>
    <dxo-header-filter [visible]="true"></dxo-header-filter>
    <dxo-search [enabled]="true"></dxo-search>

    <!-- Datum -->
    <dxi-column
      dataField="Datum"
      dataType="date"
      format="dd.MM.yyyy"
      [width]="120"
    ></dxi-column>

    <!-- Uhrzeit -->
    <dxi-column dataField="Uhrzeit" [width]="100"></dxi-column>

    <!-- Loglevel -->
    <dxi-column
      dataField="Loglevel"
      dataType="string"
      [width]="120"
    ></dxi-column>

    <!-- Nachricht mit Zeilenumbruch -->
    <dxi-column dataField="Nachricht" dataType="string">
      <ng-template #cellTemplate let-data>
        <div class="text-wrap">{{ data.value }}</div>
      </ng-template>
    </dxi-column>

    <!-- Thema -->
    <dxi-column dataField="Thema" dataType="string" [width]="350"></dxi-column>
  </dx-data-grid>

  <div *ngIf="logsDataSource.length === 0" class="alert alert-warning mt-3">
    Bitte w채hlen Sie eine Datei aus, um die Logs anzuzeigen.
  </div>
</div>

<ng-template #noFilesLoaded>
  <div class="alert alert-info">
    Keine Dateien geladen. Bitte laden Sie eine ZIP-Datei hoch.
  </div>
</ng-template>
