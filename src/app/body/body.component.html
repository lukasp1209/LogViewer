<!-- body.component.html -->

<!-- File upload section -->
<div>
  <input
    *ngIf="showUploadForm"
    type="file"
    (change)="onFileChange($event)"
    accept=".zip"
  />
</div>

<!-- Display uploaded files -->
<div *ngIf="fileUploaded">
  <ul class="nav nav-tabs">
    <li class="nav-item">
      <a
        class="nav-link active"
        *ngIf="zipContents.length > 0; else noFilesLoaded"
      >
        <p>{{ zipFile?.name }}</p>
      </a>
    </li>
  </ul>

  <!-- Navigation bar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light py-3 shadow-sm">
    <div class="container-fluid">
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarNavDropdown"
        aria-controls="navbarNavDropdown"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav d-flex flex-row align-items-center">
          <li class="nav-item">
            <select
              class="btn btn-secondary dropdown-toggle"
              id="dropdownMenuButton"
              [(ngModel)]="selectedFileName"
            >
              <option value="" disabled>Log auswählen</option>
              <option *ngFor="let file of zipContents" [value]="file.name">
                {{ file.name | slice : file.name.lastIndexOf("/") + 1 }}
              </option>
            </select>
          </li>
          <div class="filter">
            <input
              class="form-control form-control-sm"
              type="text"
              id="customWord"
              [(ngModel)]="customWord"
              placeholder="Erstelle Filter"
            />
            <button
              type="button"
              class="btn btn-secondary"
              (click)="removeCustomLines()"
            >
              Filtern
            </button>
          </div>

          <div class="input-group">
            <input
              type="datetime-local"
              class="form-control"
              [(ngModel)]="selectedDateTime"
              placeholder="Wählen Sie Datum und Uhrzeit"
            />
            <div class="input-group-append">
              <button
                class="btn btn-secondary"
                type="button"
                (click)="filterDateLogs()"
              >
                Datum
              </button>
            </div>
          </div>

          <button class="btn btn-secondary" (click)="exportCurrentContent()">
            Export
          </button>

          <!-- Log level toggle -->
          <div class="form-check form-switch ml-3">
            <input
              class="form-check-input"
              type="checkbox"
              role="switch"
              id="flexSwitchCheckChecked"
              checked
              [(ngModel)]="logHandlerService.buttonStates.LogLevel"
              (change)="onLogLevelToggleChange()"
            />
            <label class="form-check-label" for="flexSwitchCheckChecked"
              >LogLevel</label
            >
          </div>
        </ul>

        <ng-multiselect-dropdown
          class="custom-font-size ml-3"
          [placeholder]="'Filter'"
          [settings]="dropdownSettings"
          [data]="fileDataService.dropdownList"
          [(ngModel)]="fileDataService.selectedItems"
          (onSelect)="onItemSelect($event)"
          (onDeSelect)="onItemDeSelect($event)"
          (onSelectAll)="onSelectAll($event)"
          (onDeSelectAll)="onDeSelectAll()"
        >
        </ng-multiselect-dropdown>

        <ng-multiselect-dropdown
          class="custom-font-size2 ml-3"
          [placeholder]="'Highlight'"
          [settings]="dropdownSettings"
          [data]="fileDataService.markDropdownList"
          [(ngModel)]="fileDataService.markSelectedItems"
          (onSelect)="onDropdownChange()"
          (onDeSelect)="onDropdownChange()"
          (onSelectAll)="onMarkSelectAll()"
          (onDeSelectAll)="onMarkDeSelectAll()"
        >
        </ng-multiselect-dropdown>

        <!-- Search-Bar -->
        <div class="search">
          <input
            class="form-control"
            type="text"
            id="searchInput"
            [(ngModel)]="searchQuery"
            (input)="search()"
            placeholder="Suche"
          />
        </div>
      </div>
    </div>
  </nav>

  <!-- Content display area -->
  <div class="content" [attr.has-content]="selectedFileName ? 'true' : 'false'">
    <pre
      #markedContentElement
      class="scrollable-content"
      [innerHTML]="markedContent(selectedFileName)"
    ></pre>
  </div>

  <!-- Template for no files loaded -->
  <ng-template #noFilesLoaded> </ng-template>
</div>
